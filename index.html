<!DOCTYPE html>
<html lang="lt">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="mobile-web-app-capable" content="yes" />
  <title>Hip Abduction – Manual Points</title>
  <style>
    :root{ --primary:#4285f4; --green:#34a853; --amber:#f9ab00; --red:#ea4335;
           --bg:#0a0a0a; --ink:#e5e7eb; --panel:#111827; }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:var(--bg);color:var(--ink)}
    header{padding:12px 16px;background:var(--primary);color:#fff;position:sticky;top:0;z-index:5}
    h1{margin:0;font-size:18px}
    main{max-width:520px;margin:16px auto;padding:0 12px}
    .card{background:#0f1115;border-radius:12px;box-shadow:0 2px 10px rgba(0,0,0,.25);padding:12px;margin-bottom:12px}
    #wrap{position:relative;border:1px solid #1f2937;border-radius:12px;overflow:hidden;background:#000}
    #video{width:100%;height:auto;display:block;}
    #canvas{position:absolute;inset:0;touch-action:none}
    .btn{appearance:none;border:0;border-radius:10px;padding:10px 14px;background:var(--primary);color:#fff;font-weight:600;cursor:pointer}
    .btn[disabled]{opacity:.5;cursor:not-allowed}
    .row{display:flex;gap:8px;flex-wrap:wrap}
    .panel{background:var(--panel);color:#fff;border-radius:12px;padding:12px}
    .kv{display:flex;justify-content:space-between;align-items:center;margin:6px 0}
    .kv .val{font-size:22px;font-weight:800}
    .kv .lbl{opacity:.8}
    .note{font-size:14px;opacity:.9}
    .progress{height:6px;background:#1f2937;border-radius:6px;overflow:hidden}
    .progress>div{height:100%;background:var(--primary);width:0%}
    .pills{display:flex;gap:6px;flex-wrap:wrap;margin-top:6px}
    .pill{padding:4px 8px;border-radius:999px;background:#111827;font-size:12px;border:1px solid #1f2937;cursor:pointer}
    .pill.active{background:#1d4ed8;border-color:#1d4ed8}
    #statusMsg{margin-top:8px;font-weight:700}
    #tiltRow{display:flex;gap:8px;align-items:center;margin-top:8px}
    #tiltBadge{padding:2px 8px;border-radius:999px;background:#111827;border:1px solid #1f2937;font-size:12px}
  </style>
</head>
<body>
  <header><h1>Hip Abduction – Manual Points</h1></header>
  <main>
    <div class="card">
      <div class="note" style="margin-bottom:10px">
        1) Spausk <button id="startCam" class="btn" style="padding:6px 10px">Leisti kamerą</button> (pirma paprašys įvesti paciento/tyrimo kodą).<br/>
        2) Tempk taškus: LS/RS (pečiai), LH/RH (klubai), LK/RK (keliai).<br/>
        3) Vidurio linija automatiškai eina tarp pečių ir klubų vidurio, bet gali ją perstumti „MID“ rankenėle.<br/>
        4) „Išsaugoti 1 įrašą“ – iš karto išsaugos vieną matavimą (vienas JSON failas).<br/>
        5) Atsisiųsk JSON su koordinatėmis, abduction L/R, paciento kodu ir pakrypimu.
      </div>
      <div id="tiltRow">
        <button id="enableSensors" class="btn" style="padding:6px 10px">Įjungti lygio jutiklį</button>
        <span id="tiltBadge">Pakrypimas: –</span>
      </div>
    </div>

    <div class="card" id="wrap">
      <video id="video" playsinline autoplay muted></video>
      <canvas id="canvas"></canvas>
    </div>

    <div class="card panel">
      <div class="kv"><div class="lbl">Vidurkis</div><div id="avgVal" class="val">–</div></div>
      <div class="row" style="gap:12px">
        <div class="kv" style="flex:1"><div class="lbl">Abd L</div><div id="abdL" class="val">–</div></div>
        <div class="kv" style="flex:1"><div class="lbl">Abd R</div><div id="abdR" class="val">–</div></div>
      </div>

      <div id="statusMsg"></div>

      <div class="pills">
        <div class="pill active" data-show="shoulders">Show shoulders</div>
        <div class="pill active" data-show="hips">Show hips</div>
        <div class="pill active" data-show="knees">Show knees</div>
        <div class="pill active" data-show="lines">Show thigh lines</div>
        <div class="pill active" data-show="midline">Show midline</div>
        <div class="pill active" data-show="labels">Show angle labels</div>
        <div class="pill active" data-show="midHandle">Move mid handle</div>
      </div>

      <div class="progress" style="margin:10px 0"><div id="bar"></div></div>
      <div class="row">
        <button id="startRec" class="btn">Išsaugoti 1 įrašą</button>
        <button id="dl" class="btn" disabled>Atsisiųsti JSON</button>
      </div>
    </div>

    <script type="module" src="app.js"></script>
  </main>
</body>
</html>


